<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-GLhlTQ8iRABdZLl6O3oVMWSktQOp6b7In1Zl3/Jr59b6EGGoI1aFkw7cmDA6j6gD" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js" integrity="sha384-w76AqPfDkMBDXo30jS1Sgez6pr3x5MlQ1ZAGC+nuZB+EYdgRZgiwxhTBTkF7CXvN" crossorigin="anonymous"></script>
    <link href="style.css" type="text/css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <title>Home-Dashboard</title>
  </head>
    <body class="main-contents">
      <%- include('partials/nav');%>
      <main class="main-content">
        <h1 style="font-weight: bold;font-size: 70px;">Yong & Yi Paterns Enterprise</h1>
        <div>
          <h1>Sales</h1>
          <table class="table table-striped" style="width: 30%;">
            <thead>
              <tr>
                <th></th>
                <th>Amount</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>Sales ( Shoe )</td>
                <td> RM<%= totalSales.toFixed(2) %></td>
              </tr>
              <tr>
                <td>Other Income ( In the Invoice )</td>
                <td>RM<%= (totalSalesno - totalSales).toFixed(2) %></td>
              </tr>
              <tr>
                <td>Refund to Buyer</td>
                <td>RM-<%= refundsales %></td>
              </tr>
            </tbody>
            <tfoot>
              <tr>
                <th style="text-align: end;">Total Sales:</th>
                <th> RM<%= (totalSalesno - refundsales).toFixed(2) %></th>
              </tr>
            </tfoot>
          </table>
        </div><br>

        <div style="width: 90%; border-bottom: 1px solid rgb(0, 0, 0);"></div><br>
        <div>
          <h1>Cost of Goods Sold</h1>
          <table class="table table-striped" style="width: 30%;">
            <thead>
              <tr>
                <th></th>
                <th>Amount</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>Purchase</td>
                <td>RM<%= totalPurchases.toFixed(2) %></td>
              </tr>
              <tr>
                <td>Shipping</td>
                <td>RM <%= totalship.toFixed(2) %></td>
              </tr>
              <tr>
                <td>Stock Value</td>
                <td>-RM<%= totalStockValue.toFixed(2) %></td>
              </tr>
              <tr>
                <td>Refund from Supplier</td>
                <td>-RM<%= supRefunds.toFixed(2) %></td>
              </tr>
              <tr>
                <td>Other Expenses</td>
                <td>RM<%= (totalPurchasesno - totalPurchases).toFixed(2) %></td>
              </tr>
            </tbody>
            <tfoot>
              <tr>
                <th style="text-align: end;">Cost of Goods Sold:</th>
                <th> RM<%= (totalPurchasesno + totalship - totalStockValue  - supRefunds).toFixed(2) %></th>
              </tr>
            </tfoot>
          </table>
        </div><br>

        <div style="width: 90%; border-bottom: 1px solid rgb(0, 0, 0);"></div><br>
        <div>
          <h1>Gross Profit ( LOSS )</h1>
        <table class="table table-striped" style="width: 30%;">
          <thead>
            <tr>
              <th></th>
              <th>Amount</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>Sales</td>
              <td> RM<%= totalSales.toFixed(2) %></td>
            </tr>
            <tr>
              <td>Cost of Goods Sold</td>
              <td>-RM<%= (totalPurchasesno + totalship - totalStockValue).toFixed(2) %></td>
            </tr>
          </tbody>
          <tfoot>
            <tr>
              <th style="text-align: end;">Gross Profit:</th>
              <th> RM<%= (totalSalesno - (totalPurchasesno + totalship - totalStockValue)).toFixed(2) %></th>
            </tr>
          </tfoot>
        </table>
        </div><br>

        <div style="width: 90%; border-bottom: 1px solid rgb(0, 0, 0);"></div><br>
        <div>
          <h1>Expenses by Category</h1>
          <table class="table table-striped" style="width: 30%;">
            <thead>
              <tr>
                <th>Category</th>
                <th>Amount</th>
              </tr>
            </thead>
            <tbody>
              <% categories.forEach(function(category) { %>
                <tr>
                  <td><%= category.Category %></td>
                  <td>RM <%= category.total.toFixed(2) %></td>
                </tr>
              <% }); %>
            </tbody>
            <tfoot>
              <tr>
                <th style="text-align: end;">Total:</th>
                <th> RM<%= totalExpenses.toFixed(2) %></th>
              </tr>
            </tfoot>
          </table>
        </div><br>

        <div style="width: 90%; border-bottom: 1px solid rgb(0, 0, 0);"></div><br>
        <div>
          <h1>Nett Profit/(LOSS)</h1>
        <table class="table table-striped" style="width: 30%;">
          <thead>
            <tr>
              <th></th>
              <th>Amount</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>Gross Profit</td>
              <td> RM<%= (totalSalesno - (totalPurchasesno + totalship - totalStockValue)).toFixed(2) %></td>
            </tr>
            <tr>
              <td>Expenditure</td>
              <td>-RM<%= totalExpenses.toFixed(2) %></td>
            </tr>
          </tbody>
          <tfoot>
            <tr>
              <th style="text-align: end;">Total Nett Profit:</th>
              <th> RM<%= ((totalSalesno - (totalPurchasesno + totalship - totalStockValue))-totalExpenses).toFixed(2) %></th>
            </tr>
          </tfoot>
        </table>
        </div><br>

        <div style="width: 90%; border-bottom: 1px solid rgb(0, 0, 0);"></div><br>
        <div>
          <h1>Drawing</h1>
        <table class="table table-striped" style="width: 30%;">
          <thead>
            <tr>
              <th>Category</th>
              <th>Amount</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>Advance: Personal Funds to Company Used</td>
              <td>RM<%= totalp2c && totalp2c !== 0 ? totalp2c.toFixed(2) : '0.00' %></td>
            </tr>
            <tr>
              <td>Need Claim: Company Funds to Personal Used</td>
              <td>RM<%= totalc2p && totalc2p !== 0 ? totalc2p.toFixed(2) : '0.00' %></td>
            </tr>
          </tbody>
        </table>
        </div><br>

        <div style="width: 90%; border-bottom: 1px solid rgb(0, 0, 0);"></div><br>
        <div>
          <h1>Total</h1>
        <table class="table table-striped" style="width: 30%;">
          <thead>
            <tr>
              <th>Category</th>
              <th>Amount</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>Nett Profit</td>
              <td>RM<%= ((totalSalesno - (totalPurchasesno + totalship - totalStockValue))-totalExpenses).toFixed(2) %></td>
            </tr>
            <tr>
              <td>Drawing Account</td>
              <td>RM<%= (totalp2c && totalp2c !== 0 ? totalp2c.toFixed(2) : '0.00') - (totalc2p && totalc2p !== 0 ? totalc2p.toFixed(2) : '0.00') %></td>
            </tr>
          </tbody>
          <tfoot>
            <tr>
              <th style="text-align: end;">Total:</th>
              <th>RM<%= (((totalSalesno - (totalPurchasesno + totalship - totalStockValue))-totalExpenses) + 
                (totalp2c && totalp2c !== 0 ? totalp2c : 0) - (totalc2p && totalc2p !== 0 ? totalc2p : 0)).toFixed(2) %></th>
            </tr>
          </tfoot>
        </table>
        </div><br>
      </main>      
    </body>
</html>
